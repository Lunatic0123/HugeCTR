Search.setIndex({"docnames": ["api/embeddings/dense/all2all", "api/embeddings/dense/index", "api/embeddings/index", "api/embeddings/saver", "api/embeddings/sparse/distributed", "api/embeddings/sparse/index", "api/embeddings/tf_distributed_embedding", "api/index", "api/init", "api/optimizers/opts", "api/utils/index", "api/utils/opt_scope", "api/utils/opt_utils", "env_vars/env_vars", "examples/dense_demo", "examples/dlrm", "examples/index", "features/features", "get_started/get_started", "index", "intro_link", "known_issues/issues", "performance/dense_demo", "performance/index", "release_notes/release_notes"], "filenames": ["api/embeddings/dense/all2all.rst", "api/embeddings/dense/index.rst", "api/embeddings/index.rst", "api/embeddings/saver.rst", "api/embeddings/sparse/distributed.rst", "api/embeddings/sparse/index.rst", "api/embeddings/tf_distributed_embedding.rst", "api/index.rst", "api/init.rst", "api/optimizers/opts.rst", "api/utils/index.rst", "api/utils/opt_scope.rst", "api/utils/opt_utils.rst", "env_vars/env_vars.md", "examples/dense_demo.md", "examples/dlrm.md", "examples/index.rst", "features/features.md", "get_started/get_started.md", "index.rst", "intro_link.md", "known_issues/issues.md", "performance/dense_demo.md", "performance/index.rst", "release_notes/release_notes.md"], "titles": ["All2All Dense Embedding", "SparseOperationKit Dense Embeddings", "SparseOperationKit Embeddings", "SparseOperationKit Embedding Saver", "Distributed Sparse Embedding", "SparseOperationKit Sparse Embeddings", "TF Distributed Embedding", "SparseOperationKit API", "SparseOperationKit Initialize", "SparseOperationKit Optimizers", "SparseOperationKit Utilities", "SparseOperationKit Optimizer Scope", "SparseOperationKit Optimizer Utils", "Environment Variables", "Demo model using Dense Embedding Layer", "DLRM using SparseOperationKit", "Examples", "Features in SparseOperationKit", "Get Started With SparseOperationKit", "Welcome to SparseOperationKit\u2019s documentation!", "SparseOperationKit", "Known Issues", "Performance of demo model using Dense Embedding Layer", "Performance", "SparseOperationKit Release Notes"], "terms": {"class": [0, 3, 4, 6, 9, 11, 12, 18], "sparse_operation_kit": [0, 3, 4, 6, 8, 9, 11, 12, 14, 15, 18, 20], "all2all_dense_embed": 0, "all2alldenseembed": [0, 1, 18, 24], "arg": [0, 4, 6, 8, 9, 12, 18], "kwarg": [0, 4, 6, 8, 9, 12, 18], "sourc": [0, 3, 4, 6, 8, 9, 11, 12, 14, 15], "base": [0, 4, 17], "layer": [0, 3, 4, 6, 12, 18, 19, 20, 21], "abbrevi": [0, 3, 4, 8, 9, 11, 12], "sok": [0, 3, 4, 8, 9, 11, 12, 13, 17, 18, 20, 21, 22, 24], "thi": [0, 3, 4, 6, 8, 9, 11, 12, 13, 17, 18], "i": [0, 3, 4, 5, 6, 8, 11, 12, 13, 14, 17, 18, 20, 21, 22], "wrapper": [0, 4, 6], "It": [0, 4, 6, 11, 13, 20], "can": [0, 4, 6, 8, 9, 12, 13, 14, 15, 17, 18, 20, 21, 24], "us": [0, 3, 4, 6, 8, 9, 11, 12, 13, 17, 20, 21, 24], "creat": [0, 4, 6, 12, 13, 18], "which": [0, 3, 4, 8, 13, 14, 17, 18, 20, 24], "distribut": [0, 2, 5, 7, 8, 20, 24], "kei": [0, 4, 6, 17, 18, 24], "gpu_id": [0, 4, 17], "gpu_num": [0, 4, 17], "each": [0, 3, 4, 6, 8, 14, 17, 18], "gpu": [0, 4, 6, 8, 9, 13, 18, 19, 20, 21, 22], "paramet": [0, 3, 4, 6, 8, 11, 12, 20], "max_vocabulary_size_per_gpu": [0, 4, 14, 18], "integ": [0, 4, 6], "first": [0, 4, 6, 8, 18], "dimens": [0, 4, 6], "variabl": [0, 3, 4, 6, 11, 12, 18, 19], "whose": [0, 4, 6], "shape": [0, 3, 4, 6, 18], "embedding_vec_s": [0, 3, 4, 6, 14, 15, 18, 22], "second": [0, 4, 6], "slot_num": [0, 4, 14, 18, 22], "number": [0, 4, 18], "featur": [0, 4, 14, 18, 19], "file": [0, 3, 4, 6, 14, 15, 18], "process": [0, 3, 4, 8, 12, 14, 15, 17, 18, 20, 22], "same": [0, 4, 13, 17, 18, 21], "time": [0, 4], "iter": [0, 4, 18], "where": [0, 3, 4, 14, 17, 18, 20], "all": [0, 1, 3, 4, 5, 8, 9, 12, 17, 18, 20, 22], "produc": [0, 4], "vector": [0, 4, 6, 12, 17, 18], "nnz_per_slot": [0, 14, 18, 22], "valid": [0, 4, 18], "slot": [0, 4, 14, 17], "The": [0, 3, 4, 5, 6, 8, 9, 11, 14, 17, 18, 20, 21, 22, 24], "dynamic_input": 0, "boolean": [0, 4], "fals": [0, 11, 18], "whether": [0, 4, 13], "input": [0, 4, 6, 11, 12, 17, 18, 20, 24], "dynam": [0, 4, 24], "For": [0, 3, 8, 13, 14, 17, 18], "exampl": [0, 3, 4, 6, 8, 11, 12, 13, 14, 17, 18, 19, 22], "tensor": [0, 3, 4, 6, 18], "com": [0, 15, 20], "from": [0, 3, 12, 14, 17], "tf": [0, 1, 2, 3, 4, 5, 7, 8, 9, 11, 12, 13, 14, 15, 17, 21, 22, 24], "uniqu": [0, 9, 24], "when": [0, 3, 4, 6, 8, 9, 11, 14, 17, 20, 21, 24], "true": [0, 4, 12, 18, 22], "lookup": [0, 24], "gather": [0, 17, 24], "pattern": [0, 24], "By": [0, 4, 13, 14, 18], "default": [0, 4, 13, 14, 18], "mean": [0, 4, 5, 13, 17, 20, 24], "size": [0, 17], "must": [0, 3, 4, 6, 8, 18, 21], "replica_batchs": 0, "use_hasht": [0, 4], "hashtabl": [0, 4], "embeddingvari": [0, 3, 4], "insert": [0, 4, 24], "otherwis": [0, 4, 13, 21], "index": [0, 4, 18], "look": [0, 4, 17, 20], "up": [0, 3, 4, 17, 20], "so": [0, 4, 6, 12, 18], "rang": [0, 4, 18], "0": [0, 4, 13, 17, 18, 19, 21], "key_dtyp": [0, 4], "dtype": [0, 4, 6], "int64": [0, 4, 6], "data": [0, 4, 14, 17, 18, 20, 21], "type": [0, 3, 4, 6, 8, 11, 18], "embedding_initi": [0, 4], "string": [0, 3, 4, 6, 8], "an": [0, 4], "instanc": [0, 4, 14, 18, 20], "kera": [0, 4, 9, 11, 12, 18], "initi": [0, 4, 6, 7, 18, 19], "gener": [0, 4, 6], "valu": [0, 3, 4, 6], "random_uniform": [0, 4], "minval": [0, 4], "05": [0, 4], "maxval": [0, 4], "randomuniform": [0, 4], "emb_lay": [0, 4], "function": [0, 3, 4, 6, 8, 11, 12, 13, 18, 20], "def": [0, 4, 6, 11, 12, 18], "_train_step": [0, 4, 6, 11, 12, 18], "label": [0, 4, 6, 11, 12, 18], "emb_vector": [0, 4, 6, 18], "enumer": [0, 4, 6, 12, 18], "dataset": [0, 4, 6, 12, 18, 23], "call": [0, 3, 4, 6, 8, 12, 17, 18], "train": [0, 4, 12, 15, 18, 20, 24], "forward": [0, 4, 6, 17], "logic": [0, 4, 6], "ar": [0, 1, 3, 4, 5, 6, 8, 9, 12, 13, 14, 15, 17, 18, 20, 21], "store": [0, 4, 6], "row": [0, 4], "major": 0, "If": [0, 3, 13, 18, 20], "none": [0, 3, 6, 18, 22], "batchsiz": [0, 4, 18, 22], "return": [0, 3, 4, 6, 8, 11, 12, 18], "its": [0, 6, 8, 9, 13, 14, 17, 18], "equal": [0, 3, 4, 13], "float": [0, 4], "There": [1, 5, 9, 13, 17, 20, 21], "sever": [1, 5, 9, 15, 17, 20, 21], "implement": [1, 5, 9, 14, 17, 20, 24], "them": [1, 5], "equival": [1, 5, 17], "nn": [1, 5, 17, 18], "embedding_lookup": [1, 17], "all2al": [1, 2], "spars": [2, 7, 20], "dens": [2, 4, 7, 12, 18], "saver": [2, 7], "tfdistributedembed": [2, 6], "current": [3, 6, 8], "you": [3, 13, 14, 15, 18, 20, 21], "explicitli": 3, "dump": [3, 18], "load": 3, "trainabl": [3, 11, 12], "those": [3, 12, 21], "And": [3, 8, 14, 15, 17, 18, 20], "other": [3, 8, 12, 13, 18, 20], "still": 3, "manag": [3, 11], "dl": [3, 20, 24], "framework": [3, 20, 24], "dump_to_fil": 3, "embedding_vari": [3, 12], "filepath": 3, "save": [3, 4, 6, 14, 15], "specifi": [3, 4, 6, 8, 13, 14, 18], "host": 3, "multipl": [3, 6, 13, 17, 18, 20, 21, 22], "cpu": [3, 8, 14, 18, 22], "within": 3, "distributedvari": 3, "need": [3, 11, 12, 20], "directori": 3, "statu": [3, 8], "op": [3, 13, 24], "execut": [3, 8, 21], "successfulli": [3, 8, 18], "ok": [3, 8], "restore_from_fil": 3, "restor": 3, "load_embedding_valu": 3, "assign": 3, "": [3, 6, 8, 13, 15, 18, 21], "list": [3, 11, 12, 18], "tupl": [3, 11, 12], "2": [3, 4, 8, 9, 14, 19, 22, 24], "rank": [3, 4, 15], "make": [3, 13, 18, 21], "big": 3, "just": 3, "like": [3, 14], "thei": [3, 14], "stack": 3, "bs_0": 3, "bs_1": 3, "bs_2": 3, "treat": 3, "distributed_embed": 4, "distributedembed": [4, 5, 12], "combin": [4, 5, 17], "how": [4, 13, 14, 15, 18], "intra": [4, 14, 17], "sum": [4, 5, 17, 18], "max_nnz": 4, "maximum": 4, "max_feature_num": 4, "sampl": [4, 14, 18, 22], "memori": [4, 20], "statist": 4, "known": [4, 17, 19], "max": 4, "_featur": 4, "_num": 4, "_nnz": 4, "sparsetensor": 4, "dense_shap": 4, "dim": 4, "denot": 4, "therefor": [4, 14, 18, 20], "indic": [4, 13], "column": 4, "correspond": 4, "Its": 4, "embedding_lookup_spars": [5, 17], "support": [5, 17, 18, 20, 24], "build": [6, 13, 14, 15], "model": [6, 11, 12, 15, 19, 20], "parallel": [6, 14, 18, 19, 20], "total": [6, 24], "tensorflow": [6, 8, 9, 11, 13, 19, 20, 22, 24], "api": [6, 8, 18, 19], "util": [6, 7, 19, 20], "strategi": [6, 8, 11, 12, 20], "do": [6, 8], "commun": [6, 18, 24], "among": [6, 17, 20, 21], "differ": [6, 12, 14, 17, 18, 21, 24], "tf_distributed_embed": 6, "leverag": [6, 8, 18, 20], "vocabulary_s": [6, 14], "numpi": 6, "arrai": 6, "glorotnorm": 6, "comm_opt": 6, "experiment": 6, "communicationopt": 6, "see": [6, 20], "doc": [6, 19], "scope": [6, 7, 8, 10, 12, 18], "embedding_lay": [6, 12, 15, 18], "run": [6, 8, 12, 18], "note": [6, 11, 18, 19], "correctli": 6, "int32": 6, "replica_output": 6, "replica": 6, "float32": 6, "init": [7, 8, 18], "embed": [7, 11, 12, 18, 19, 20, 21, 24], "optim": [7, 10, 14, 18, 19, 24], "adam": [7, 11, 14, 18, 24], "local": 7, "updat": 7, "core": [8, 11, 18], "avail": [8, 13, 18, 20], "pleas": [8, 9, 13, 18, 20], "set": [8, 18], "cuda_visible_devic": [8, 18], "config": [8, 18, 24], "set_visible_devic": [8, 18, 24], "befor": [8, 18, 22], "launch": [8, 18, 21], "runtim": [8, 19], "In": [8, 17, 18, 20, 21], "x": [8, 19], "horovod": [8, 20, 24], "under": [8, 18], "import": [8, 19, 20], "hvd": [8, 18], "1": [8, 12, 13, 14, 15, 17, 19, 21, 22], "15": [8, 19, 24], "onli": [8, 11, 13, 18, 20], "work": [8, 17, 20], "retur": 8, "evalu": 8, "sess": [8, 18], "step": [8, 12, 18, 20], "ani": [8, 13, 17], "sok_init": 8, "global_batch_s": [8, 14, 15, 18], "session": [8, 18], "dictionari": 8, "keyword": 8, "argument": [8, 9, 22], "contain": 8, "content": 8, "insid": 9, "unsorted_segment_sum": 9, "replac": 9, "version": [9, 18, 19], "4": [9, 14, 15, 22, 24], "obtain": 9, "perform": [9, 18, 19], "gain": 9, "while": 9, "5": [9, 18, 22], "should": [9, 17], "ident": [9, 18], "refer": [9, 18], "http": [9, 15, 20], "googl": 9, "cn": 9, "api_doc": 9, "python": [9, 14, 18, 20], "document": [9, 14, 15, 18], "split_embedding_variable_from_oth": [10, 11, 12, 18], "optimizerscop": [10, 11, 18], "context_scop": 11, "trainable_vari": [11, 12, 18], "context": 11, "along": [11, 12], "nativ": [11, 18], "context_manag": 11, "switch": [11, 13], "handl": 11, "emb_opt": [11, 18], "other_opt": 11, "gradienttap": [11, 12, 18], "tape": [11, 12, 18], "logit": [11, 18], "loss": [11, 12, 18], "loss_fn": [11, 12, 18], "emb_var": [11, 12, 18], "other_var": [11, 12, 18], "emb_grad": [11, 18], "other_grad": [11, 18], "gradient": [11, 17, 18], "apply_gradi": [11, 18], "zip": [11, 18], "experimental_aggregate_gradi": [11, 18], "dense_opt": [11, 18], "mai": 11, "next": 11, "releas": [11, 13, 19], "split": 12, "automat": [12, 18], "sinc": 12, "aggreg": 12, "we": [12, 14, 21], "wai": [12, 20], "other_vari": 12, "normal": 12, "__init__": [12, 18], "self": [12, 18], "super": [12, 18], "dense_lay": [12, 18], "unit": [12, 14, 18], "out": 12, "two": 13, "kind": 13, "sparseoperationkit": [13, 14, 21], "respect": [13, 14], "These": [13, 17, 20], "dure": [13, 24], "configur": [13, 24], "comput": 13, "capabl": 13, "target": 13, "devic": [13, 21, 24], "70": 13, "75": 13, "80": 13, "want": [13, 18, 20], "env": 13, "var": 13, "semicolon": 13, "separ": 13, "sm": 13, "export": [13, 15], "60": 13, "65": 13, "enabl": 13, "dedic": [13, 20, 24], "cuda": [13, 22, 24], "stream": [13, 24], "off": 13, "nvtx": [13, 14, 22], "mark": 13, "disabl": 13, "ON": 13, "On": 13, "debug": 13, "mode": 13, "built": [13, 18], "some": [13, 18], "assert": 13, "synchroniz": 13, "cudaeventsynchron": 13, "wait": 13, "complet": 13, "cudastreamwaitev": 13, "depend": [13, 21], "between": [13, 21], "except": [13, 17], "synchron": [13, 18, 20, 24], "demonstr": [14, 15], "dnn": [14, 18, 20], "reduct": [14, 17, 18], "conduct": [14, 17, 18], "find": [14, 15, 20], "code": [14, 15, 20], "tutori": [14, 15], "densedemo": [14, 16, 19, 22, 23], "modul": 14, "cupi": 14, "mpi4pi": 14, "construct": 14, "7": [14, 18], "fulli": [14, 18, 20], "connect": 14, "former": 14, "6": 14, "have": [14, 20], "1024": [14, 15, 18], "output": 14, "last": 14, "one": [14, 17, 18, 20], "ha": 14, "command": 14, "randomli": 14, "filenam": 14, "ad": [14, 23, 24], "xxx": 14, "python3": [14, 15, 18, 22], "gen_data": 14, "py": [14, 15, 18, 20, 22], "65536": [14, 18, 22], "100": [14, 22], "10": [14, 18, 22], "iter_num": 14, "30": 14, "d": 14, "let": 14, "own": [14, 18], "dataread": 14, "read": 14, "splite": 14, "name": 14, "save_prefix": [14, 15], "split_id": 14, "data_0": 14, "data_1": 14, "linearli": 14, "arrang": 14, "s0": 14, "s1": 14, "s2": 14, "s3": 14, "s4": 14, "s5": 14, "s6": 14, "s7": 14, "split_data": 14, "split_num": 14, "8": [14, 17, 18, 22], "data_": 14, "method": 14, "mpiexec": [14, 15, 18], "n": 14, "allow": [14, 15], "root": [14, 15], "run_tf": 14, "data_filenam": 14, "8192": [14, 22], "num_dense_lay": 14, "data_split": 14, "run_sok_mirroredstrategi": 14, "add": [14, 21, 22], "oversubscrib": 14, "enough": 14, "run_sok_multiworker_mpi": 14, "horovodrun": [14, 18], "np": [14, 15, 18], "h": [14, 18], "localhost": [14, 18], "run_sok_horovod": 14, "data_filename_prefix": 14, "criteo": [15, 23], "terabyt": [15, 23], "download": [15, 20], "option": 15, "follow": [15, 17, 20], "instruct": 15, "csv": 15, "hugectr": [15, 24], "Then": 15, "convert": 15, "binari": 15, "bin2csv": 15, "input_fil": 15, "yourbinaryfilepath": 15, "bin": 15, "num_output_fil": 15, "output_path": 15, "train_": 15, "test": 15, "64": 15, "test_": 15, "embedding_dim": 15, "32": 15, "main": [15, 18], "16384": 15, "train_file_pattern": 15, "test_file_pattern": 15, "bottom_stack": 15, "512": 15, "256": 15, "top_stack": 15, "distribute_strategi": 15, "multiwork": 15, "tf_mp": 15, "arxiv": 15, "org": 15, "pdf": 15, "1906": 15, "00091": 15, "lab": 15, "2013": 15, "12": 15, "click": [15, 20], "log": 15, "github": [15, 20], "tree": 15, "master": 15, "offici": 15, "recommend": [15, 18, 20], "dlrm": [16, 19, 23], "detail": 17, "inform": 17, "about": [17, 20], "As": 17, "describ": [17, 18], "introduct": [17, 19], "section": [17, 18], "provid": [17, 20], "manner": [17, 20], "doe": [17, 20], "requir": 17, "further": [17, 20], "transform": [17, 20], "paral": 17, "algorithm": [17, 20, 24], "singl": [17, 18, 20, 22, 24], "machin": [17, 18, 20], "mp": [17, 20], "1000": 17, "1001": 17, "pictur": [17, 20], "depict": [17, 18, 20], "propag": 17, "To": 17, "reduc": [17, 18], "overhead": 17, "tabl": 17, "huge": [17, 20], "tini": 17, "also": 17, "field": 17, "unifi": 17, "encod": 17, "collect": [17, 22], "oper": [17, 20], "scatter": 17, "backward": 17, "exchang": 17, "anoth": 17, "top": 17, "walk": 18, "through": [18, 20], "simpl": 18, "demo": 18, "familiar": 18, "expert": 18, "more": [18, 20], "assum": 18, "relat": 18, "tool": [18, 24], "your": [18, 20], "system": [18, 20], "now": 18, "detect": 18, "signatur": 18, "structur": 18, "fig": 18, "demomodel": 18, "embedding_vector_s": 18, "num_of_dense_lay": 18, "per": 18, "concaten": 18, "_": 18, "activ": 18, "relu": 18, "append": 18, "out_lay": 18, "reshap": 18, "hidden": 18, "compat": [18, 20], "specificli": 18, "exist": [18, 21], "program": [18, 21], "multi": [18, 24], "thread": 18, "But": 18, "due": [18, 20], "gil": 18, "cpython": 18, "interpret": 18, "hard": [18, 20], "might": [18, 21], "impact": 18, "end": 18, "infer": [18, 20], "mani": 18, "use_tf_opt": 18, "16": 18, "learning_r": 18, "els": 18, "initil": 18, "binarycrossentropi": 18, "from_logit": 18, "_replica_loss": 18, "compute_average_loss": 18, "labl": 18, "grad": 18, "replica_loss": 18, "total_loss": 18, "reduceop": 18, "axi": 18, "print": 18, "info": 18, "format": 18, "after": [18, 23], "control": 18, "o": [18, 22], "json": 18, "worker_num": 18, "task_id": 18, "environ": [18, 19], "str": 18, "procecss": 18, "port": 18, "12345": 18, "could": 18, "arbitrari": 18, "unus": 18, "tf_config": 18, "cluster": [18, 20], "worker": 18, "task": 18, "check": [18, 20], "becaus": [18, 20], "mpi": [18, 22], "similar": 18, "local_rank": 18, "first_batch": 18, "allreduc": 18, "broadcast_vari": 18, "root_rank": 18, "restrict": 18, "sok_init_op": 18, "train_step": 18, "colocate_gradients_with_op": 18, "len": 18, "emb_train_op": 18, "other_train_op": 18, "control_depend": [18, 21], "init_op": 18, "group": 18, "global_variables_initi": 18, "local_variables_initi": 18, "loss_v": 18, "even": 18, "instal": [19, 24], "get": 19, "start": 19, "what": 19, "new": 19, "compil": 19, "issu": [19, 24], "nccl": 19, "conflict": 19, "packag": 20, "wrap": 20, "acceler": 20, "case": 20, "design": 20, "common": [20, 24], "deeplearn": 20, "most": 20, "extract": 20, "across": 20, "node": [20, 24], "estim": 20, "rate": 20, "ctr": 20, "veri": 20, "effici": 20, "solut": [20, 21], "scenario": 20, "amount": 20, "fit": 20, "whole": 20, "avaiabl": 20, "matter": 20, "locat": 20, "dp": 20, "minim": 20, "chang": 20, "With": 20, "mix": 20, "consum": 20, "littl": 20, "resourc": 20, "integr": [20, 24], "hous": 20, "feed": 20, "scale": 20, "workflow": 20, "docker": 20, "imag": 20, "nvcr": 20, "io": 20, "nvidia": 20, "merlin": 20, "21": 20, "11": 20, "sparseopeationkit": 20, "alreadi": 20, "directrli": 20, "via": [20, 24], "sparse_opeation_kit": 20, "pip": [20, 24], "user": 20, "souc": 20, "here": 20, "git": 20, "clone": 20, "cd": 20, "setup": 20, "our": 20, "try": 21, "fix": [21, 24], "shose": 21, "futur": 21, "transfer": 21, "order": 21, "determinist": 21, "hang": [21, 24], "problem": 21, "forc": 21, "introduc": 22, "trace": 22, "fork": 22, "exec": 22, "timelin": 22, "nsy": 22, "backtrac": 22, "cudabacktrac": 22, "cpuctxsw": 22, "f": 22, "profiling_filenam": 22, "script": 22, "dgx": 22, "a100": 22, "nsightsystem": 22, "linux": 22, "cli": 22, "public": 22, "2021": 22, "58": 22, "origin": 22, "179": 22, "85": 22, "25": 22, "90": 22, "45": 22, "36": 22, "45548": 22, "316269": 22, "1444925": 22, "perflab": 23, "verifi": 23, "visibl": 24, "mirroredstrategi": 24, "greater": 24, "than": 24, "identityhasht": 24, "hash": 24, "map": 24, "easili": 24, "distributedsparseembed": 24, "custom": 24}, "objects": {"sparse_operation_kit.core.context_scope": [[11, 0, 1, "", "OptimizerScope"]], "sparse_operation_kit.core": [[8, 1, 0, "-", "initialize"]], "sparse_operation_kit.core.initialize": [[8, 2, 1, "", "Init"]], "sparse_operation_kit.embeddings.all2all_dense_embedding": [[0, 0, 1, "", "All2AllDenseEmbedding"]], "sparse_operation_kit.embeddings.all2all_dense_embedding.All2AllDenseEmbedding": [[0, 3, 1, "", "call"]], "sparse_operation_kit.embeddings.distributed_embedding": [[4, 0, 1, "", "DistributedEmbedding"]], "sparse_operation_kit.embeddings.distributed_embedding.DistributedEmbedding": [[4, 3, 1, "", "call"]], "sparse_operation_kit.embeddings.tf_distributed_embedding": [[6, 0, 1, "", "TFDistributedEmbedding"]], "sparse_operation_kit.embeddings.tf_distributed_embedding.TFDistributedEmbedding": [[6, 3, 1, "", "call"]], "sparse_operation_kit.optimizers": [[12, 1, 0, "-", "utils"]], "sparse_operation_kit.optimizers.utils": [[12, 2, 1, "", "split_embedding_variable_from_others"]], "sparse_operation_kit.saver.Saver": [[3, 0, 1, "", "Saver"]], "sparse_operation_kit.saver.Saver.Saver": [[3, 3, 1, "", "dump_to_file"], [3, 3, 1, "", "load_embedding_values"], [3, 3, 1, "", "restore_from_file"]], "sparse_operation_kit.tf.keras.optimizers.adam": [[9, 0, 1, "", "Adam"]]}, "objtypes": {"0": "py:class", "1": "py:module", "2": "py:function", "3": "py:method"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "module", "Python module"], "2": ["py", "function", "Python function"], "3": ["py", "method", "Python method"]}, "titleterms": {"all2al": [0, 17], "dens": [0, 1, 14, 17, 22], "embed": [0, 1, 2, 3, 4, 5, 6, 14, 17, 22], "sparseoperationkit": [1, 2, 3, 5, 7, 8, 9, 10, 11, 12, 15, 17, 18, 19, 20, 24], "saver": 3, "distribut": [4, 6, 17, 18], "spars": [4, 5, 17], "tf": [6, 18], "api": 7, "initi": 8, "optim": [9, 11, 12], "adam": 9, "local": 9, "updat": 9, "util": [10, 12], "scope": 11, "environ": 13, "variabl": 13, "compil": 13, "sok_compile_gpu_sm": 13, "sok_compile_async": 13, "valu": 13, "accept": 13, "sok_compile_use_nvtx": 13, "sok_compile_build_typ": 13, "runtim": 13, "sok_event_sync": 13, "demo": [14, 22], "model": [14, 17, 18, 22], "us": [14, 15, 18, 22], "layer": [14, 17, 22], "requir": 14, "structur": 14, "step": [14, 15], "gener": [14, 15], "dataset": [14, 15], "split": 14, "whole": 14, "multipl": 14, "shard": 14, "run": [14, 15], "thi": [14, 20], "writen": 14, "tensorflow": [14, 15, 18], "sok": [14, 15], "mirroredstrategi": [14, 18], "multiworkermirroredstrategi": [14, 18], "mpi": 14, "horovod": [14, 18], "dlrm": 15, "option1": 15, "option2": 15, "set": 15, "common": 15, "param": 15, "refer": 15, "exampl": 16, "featur": [17, 20], "parallel": 17, "gpu": 17, "get": 18, "start": 18, "With": 18, "see": 18, "also": 18, "import": 18, "instal": [18, 20], "2": 18, "x": 18, "defin": 18, "strategi": 18, "caution": 18, "tip": 18, "1": [18, 24], "15": 18, "welcom": 19, "": [19, 24], "document": [19, 20], "modul": 20, "along": 20, "hugectr": 20, "from": 20, "pypi": 20, "build": 20, "sourc": 20, "known": 21, "issu": 21, "nccl": 21, "conflict": 21, "perform": [22, 23], "profil": 22, "command": 22, "infrastructur": 22, "number": 22, "end2end": 22, "elaps": 22, "time": 22, "milisecond": 22, "queri": 22, "per": 22, "second": 22, "releas": 24, "note": 24, "what": 24, "new": 24, "version": 24, "0": 24}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "sphinx.ext.intersphinx": 1, "sphinx": 57}, "alltitles": {"All2All Dense Embedding": [[0, "all2all-dense-embedding"], [17, "all2all-dense-embedding"]], "SparseOperationKit Dense Embeddings": [[1, "sparseoperationkit-dense-embeddings"]], "SparseOperationKit Embeddings": [[2, "sparseoperationkit-embeddings"]], "SparseOperationKit Embedding Saver": [[3, "sparseoperationkit-embedding-saver"]], "Distributed Sparse Embedding": [[4, "distributed-sparse-embedding"], [17, "distributed-sparse-embedding"]], "SparseOperationKit Sparse Embeddings": [[5, "sparseoperationkit-sparse-embeddings"]], "TF Distributed Embedding": [[6, "tf-distributed-embedding"]], "SparseOperationKit API": [[7, "sparseoperationkit-api"]], "SparseOperationKit Initialize": [[8, "module-sparse_operation_kit.core.initialize"]], "SparseOperationKit Optimizers": [[9, "sparseoperationkit-optimizers"]], "Adam optimizer": [[9, "adam-optimizer"]], "Local update Adam optimizer": [[9, "local-update-adam-optimizer"]], "SparseOperationKit Utilities": [[10, "sparseoperationkit-utilities"]], "SparseOperationKit Optimizer Scope": [[11, "sparseoperationkit-optimizer-scope"]], "SparseOperationKit Optimizer Utils": [[12, "module-sparse_operation_kit.optimizers.utils"]], "Environment Variables": [[13, "environment-variables"]], "Compile Variables": [[13, "compile-variables"]], "SOK_COMPILE_GPU_SM": [[13, "sok-compile-gpu-sm"]], "SOK_COMPILE_ASYNC": [[13, "sok-compile-async"]], "values accepted": [[13, "values-accepted"], [13, "id1"], [13, "id2"], [13, "id3"]], "SOK_COMPILE_USE_NVTX": [[13, "sok-compile-use-nvtx"]], "SOK_COMPILE_BUILD_TYPE": [[13, "sok-compile-build-type"]], "Runtime Variables": [[13, "runtime-variables"]], "SOK_EVENT_SYNC": [[13, "sok-event-sync"]], "Demo model using Dense Embedding Layer": [[14, "demo-model-using-dense-embedding-layer"]], "requirements": [[14, "requirements"]], "model structure": [[14, "model-structure"]], "steps": [[14, "steps"], [15, "steps"]], "Generate datasets": [[14, "generate-datasets"], [15, "generate-datasets"]], "Split the whole dataset into multiple shards": [[14, "split-the-whole-dataset-into-multiple-shards"]], "Run this demo writen with TensorFlow": [[14, "run-this-demo-writen-with-tensorflow"]], "Run this demo writen with SOK + MirroredStrategy": [[14, "run-this-demo-writen-with-sok-mirroredstrategy"]], "Run this demo writen with SOK + MultiWorkerMirroredStrategy + MPI": [[14, "run-this-demo-writen-with-sok-multiworkermirroredstrategy-mpi"]], "Run this demo writen with SOK + Horovod": [[14, "run-this-demo-writen-with-sok-horovod"]], "DLRM using SparseOperationKit": [[15, "dlrm-using-sparseoperationkit"]], "[Option1]": [[15, "option1"]], "[Option2]": [[15, "option2"]], "Set common params": [[15, "set-common-params"]], "Run DLRM with TensorFlow": [[15, "run-dlrm-with-tensorflow"]], "Run DLRM with SOK": [[15, "run-dlrm-with-sok"]], "reference": [[15, "reference"]], "Examples": [[16, "examples"]], "Features in SparseOperationKit": [[17, "features-in-sparseoperationkit"]], "Model-Parallelism GPU Embedding Layer": [[17, "model-parallelism-gpu-embedding-layer"]], "Sparse Embedding Layer": [[17, "sparse-embedding-layer"]], "Dense Embedding Layer": [[17, "dense-embedding-layer"]], "Get Started With SparseOperationKit": [[18, "get-started-with-sparseoperationkit"]], "See also": [[18, null]], "Important": [[18, null], [18, null]], "Install SparseOperationKit": [[18, "install-sparseoperationkit"]], "Import SparseOperationKit": [[18, "import-sparseoperationkit"]], "TensorFlow 2.x": [[18, "tensorflow-2-x"]], "Define a model with TensorFlow": [[18, "define-a-model-with-tensorflow"]], "Use SparseOperationKit with tf.distribute.Strategy": [[18, "use-sparseoperationkit-with-tf-distribute-strategy"]], "with tf.distribute.MirroredStrategy": [[18, "with-tf-distribute-mirroredstrategy"]], "Caution": [[18, null], [18, null]], "Tip": [[18, null]], "With tf.distribute.MultiWorkerMirroredStrategy": [[18, "with-tf-distribute-multiworkermirroredstrategy"]], "Use SparseOperationKit with Horovod": [[18, "use-sparseoperationkit-with-horovod"]], "TensorFlow 1.15": [[18, "tensorflow-1-15"]], "Using SparseOperationKit with Horovod": [[18, "using-sparseoperationkit-with-horovod"]], "Welcome to SparseOperationKit\u2019s documentation!": [[19, "welcome-to-sparseoperationkit-s-documentation"]], "SparseOperationKit": [[20, "sparseoperationkit"]], "Features": [[20, "features"]], "Installation": [[20, "installation"]], "Install this module along with HugeCTR": [[20, "install-this-module-along-with-hugectr"]], "Install this module from pypi": [[20, "install-this-module-from-pypi"]], "Build from source": [[20, "build-from-source"]], "Documents": [[20, "documents"]], "Known Issues": [[21, "known-issues"]], "NCCL conflicts": [[21, "nccl-conflicts"]], "Performance of demo model using Dense Embedding Layer": [[22, "performance-of-demo-model-using-dense-embedding-layer"]], "Profiling commands": [[22, "profiling-commands"]], "Infrastructure": [[22, "infrastructure"]], "Performance Numbers": [[22, "performance-numbers"]], "end2end elapsed time (miliseconds)": [[22, "end2end-elapsed-time-miliseconds"]], "Query per seconds": [[22, "query-per-seconds"]], "Performance": [[23, "performance"]], "SparseOperationKit Release Notes": [[24, "sparseoperationkit-release-notes"]], "What\u2019s new in Version 1.1.0": [[24, "whats-new-in-version-1-1-0"]], "What\u2019s new in Version 1.0.1": [[24, "whats-new-in-version-1-0-1"]], "What\u2019s new in Version 1.0.0": [[24, "whats-new-in-version-1-0-0"]]}, "indexentries": {"all2alldenseembedding (class in sparse_operation_kit.embeddings.all2all_dense_embedding)": [[0, "sparse_operation_kit.embeddings.all2all_dense_embedding.All2AllDenseEmbedding"]], "call() (sparse_operation_kit.embeddings.all2all_dense_embedding.all2alldenseembedding method)": [[0, "sparse_operation_kit.embeddings.all2all_dense_embedding.All2AllDenseEmbedding.call"]], "saver (class in sparse_operation_kit.saver.saver)": [[3, "sparse_operation_kit.saver.Saver.Saver"]], "dump_to_file() (sparse_operation_kit.saver.saver.saver method)": [[3, "sparse_operation_kit.saver.Saver.Saver.dump_to_file"]], "load_embedding_values() (sparse_operation_kit.saver.saver.saver method)": [[3, "sparse_operation_kit.saver.Saver.Saver.load_embedding_values"]], "restore_from_file() (sparse_operation_kit.saver.saver.saver method)": [[3, "sparse_operation_kit.saver.Saver.Saver.restore_from_file"]], "distributedembedding (class in sparse_operation_kit.embeddings.distributed_embedding)": [[4, "sparse_operation_kit.embeddings.distributed_embedding.DistributedEmbedding"]], "call() (sparse_operation_kit.embeddings.distributed_embedding.distributedembedding method)": [[4, "sparse_operation_kit.embeddings.distributed_embedding.DistributedEmbedding.call"]], "tfdistributedembedding (class in sparse_operation_kit.embeddings.tf_distributed_embedding)": [[6, "sparse_operation_kit.embeddings.tf_distributed_embedding.TFDistributedEmbedding"]], "call() (sparse_operation_kit.embeddings.tf_distributed_embedding.tfdistributedembedding method)": [[6, "sparse_operation_kit.embeddings.tf_distributed_embedding.TFDistributedEmbedding.call"]], "init() (in module sparse_operation_kit.core.initialize)": [[8, "sparse_operation_kit.core.initialize.Init"]], "module": [[8, "module-sparse_operation_kit.core.initialize"], [12, "module-sparse_operation_kit.optimizers.utils"]], "sparse_operation_kit.core.initialize": [[8, "module-sparse_operation_kit.core.initialize"]], "adam (class in sparse_operation_kit.tf.keras.optimizers.adam)": [[9, "sparse_operation_kit.tf.keras.optimizers.adam.Adam"]], "optimizerscope (class in sparse_operation_kit.core.context_scope)": [[11, "sparse_operation_kit.core.context_scope.OptimizerScope"]], "sparse_operation_kit.optimizers.utils": [[12, "module-sparse_operation_kit.optimizers.utils"]], "split_embedding_variable_from_others() (in module sparse_operation_kit.optimizers.utils)": [[12, "sparse_operation_kit.optimizers.utils.split_embedding_variable_from_others"]]}})