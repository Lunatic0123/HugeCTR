Search.setIndex({docnames:["api/embeddings/dense/all2all","api/embeddings/dense/index","api/embeddings/index","api/embeddings/saver","api/embeddings/sparse/distributed","api/embeddings/sparse/index","api/embeddings/tf_distributed_embedding","api/index","api/init","api/optimizers/opts","api/utils/index","api/utils/opt_scope","api/utils/opt_utils","env_vars/env_vars","examples/dense_demo","examples/dlrm","examples/index","features/features","get_started/get_started","index","intro_link","known_issues/issues","performance/dense_demo","performance/index","release_notes/release_notes"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":4,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":3,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,"sphinx.ext.viewcode":1,sphinx:56},filenames:["api/embeddings/dense/all2all.rst","api/embeddings/dense/index.rst","api/embeddings/index.rst","api/embeddings/saver.rst","api/embeddings/sparse/distributed.rst","api/embeddings/sparse/index.rst","api/embeddings/tf_distributed_embedding.rst","api/index.rst","api/init.rst","api/optimizers/opts.rst","api/utils/index.rst","api/utils/opt_scope.rst","api/utils/opt_utils.rst","env_vars/env_vars.md","examples/dense_demo.md","examples/dlrm.md","examples/index.rst","features/features.md","get_started/get_started.md","index.rst","intro_link.md","known_issues/issues.md","performance/dense_demo.md","performance/index.rst","release_notes/release_notes.md"],objects:{"sparse_operation_kit.core":[[8,1,0,"-","initialize"]],"sparse_operation_kit.core.context_scope":[[11,0,1,"","OptimizerScope"]],"sparse_operation_kit.core.initialize":[[8,2,1,"","Init"]],"sparse_operation_kit.embeddings.all2all_dense_embedding":[[0,0,1,"","All2AllDenseEmbedding"]],"sparse_operation_kit.embeddings.all2all_dense_embedding.All2AllDenseEmbedding":[[0,3,1,"","call"]],"sparse_operation_kit.embeddings.distributed_embedding":[[4,0,1,"","DistributedEmbedding"]],"sparse_operation_kit.embeddings.distributed_embedding.DistributedEmbedding":[[4,3,1,"","call"]],"sparse_operation_kit.embeddings.tf_distributed_embedding":[[6,0,1,"","TFDistributedEmbedding"]],"sparse_operation_kit.embeddings.tf_distributed_embedding.TFDistributedEmbedding":[[6,3,1,"","call"]],"sparse_operation_kit.optimizers":[[12,1,0,"-","utils"]],"sparse_operation_kit.optimizers.utils":[[12,2,1,"","split_embedding_variable_from_others"]],"sparse_operation_kit.saver.Saver":[[3,0,1,"","Saver"]],"sparse_operation_kit.saver.Saver.Saver":[[3,3,1,"","dump_to_file"],[3,3,1,"","load_embedding_values"],[3,3,1,"","restore_from_file"]],"sparse_operation_kit.tf.keras.optimizers.adam":[[9,0,1,"","Adam"]],"sparse_operation_kit.tf.keras.optimizers.lazy_adam":[[9,0,1,"","LazyAdamOptimizer"]]},objnames:{"0":["py","class","Python class"],"1":["py","module","Python module"],"2":["py","function","Python function"],"3":["py","method","Python method"]},objtypes:{"0":"py:class","1":"py:module","2":"py:function","3":"py:method"},terms:{"0":[0,4,13,17,18,19,21],"00091":15,"1":[4,8,9,12,13,14,15,17,19,21,22],"10":[14,18,22],"100":[14,22],"1000":17,"1001":17,"1024":[14,15,18],"11":20,"12":15,"12345":18,"1444925":22,"15":[8,9,19,24],"16":18,"16384":15,"179":22,"1906":15,"2":[3,4,8,9,14,19,22,24],"2013":15,"2021":22,"21":20,"25":22,"256":15,"30":14,"316269":22,"32":15,"36":22,"4":[9,14,15,22,24],"45":22,"45548":22,"5":[9,18,22],"512":15,"58":22,"6":14,"60":13,"64":15,"65":13,"65536":[14,18,22],"7":[14,18],"70":13,"75":13,"8":[14,17,18,22],"80":13,"8192":[14,22],"85":22,"90":22,"boolean":[0,4],"case":20,"class":[0,3,4,6,9,11,12,18],"default":[0,4,13,14,18],"do":[6,8],"export":[13,15],"float":[0,4],"function":[0,3,4,6,8,11,12,13,18,20],"import":[8,19,20],"new":19,"public":22,"return":[0,3,4,6,8,11,12,18],"super":[12,18],"switch":[11,13],"true":[0,4,12,18,22],"try":21,"var":13,"while":9,And:[3,8,14,15,17,18,20],As:17,But:18,By:[0,4,13,14,18],For:[0,3,8,13,14,17,18],If:[0,3,13,18,20],In:[8,17,18,20,21],It:[0,4,6,9,11,13,20],Its:4,ON:13,On:13,The:[0,3,4,5,6,8,9,11,14,17,18,20,21,22,24],Then:15,There:[1,5,9,13,17,20,21],These:[13,17,20],To:17,With:20,_:18,__init__:[12,18],_featur:4,_nnz:4,_num:4,_replica_loss:18,_train_step:[0,4,6,11,12,18],a100:22,abbrevi:[0,3,4,8,9,11,12],about:[17,20],acceler:20,across:20,activ:18,actual:9,ad:[14,23,24],adam:[7,11,14,18,24],add:[14,21,22],after:[18,23],aggreg:12,algorithm:[17,20,24],all2al:[1,2],all2all_dense_embed:0,all2alldenseembed:[0,18,24],all:[0,1,3,4,5,8,9,12,17,18,20,22],allow:[14,15],allreduc:18,along:[11,12],alreadi:20,also:17,although:9,among:[6,17,20,21],amount:20,ani:[8,13,17],anoth:17,api:[6,8,18,19],api_doc:9,append:18,apply_gradi:[11,18],ar:[0,1,3,4,5,6,8,9,12,13,14,15,17,18,20,21],arbitrari:18,arg:[0,4,6,8,9,12,18],argument:[8,9,22],arrai:6,arrang:14,arxiv:15,assert:13,assign:3,assum:18,automat:[12,18],avaiabl:20,avail:[8,9,13,18,20],axi:18,backtrac:22,backward:17,base:[0,4,17],base_lay:[0,4],batchsiz:[0,4,18,22],becaus:[18,20],befor:[8,18,22],between:[13,21],big:3,bin2csv:15,bin:15,binari:15,binarycrossentropi:18,bottom_stack:15,broadcast_vari:18,bs_0:3,bs_1:3,bs_2:3,build:[6,13,14,15],built:[13,18],call:[0,3,4,6,8,12,17,18],can:[0,4,6,8,9,12,13,14,15,17,18,20,21,24],capabl:13,cd:20,chang:20,check:[18,20],cli:22,click:[15,20],clone:20,cluster:[18,20],cn:9,code:[14,15,20],collect:[17,22],colocate_gradients_with_op:18,column:4,com:[0,15,20],combin:[4,5,17],comm_opt:6,command:14,common:[20,24],commun:[6,18,24],communicationopt:6,compat:[18,20],compil:19,complet:13,comput:13,compute_average_loss:18,concaten:18,conduct:[14,17,18],config:[8,18,24],configur:[13,24],conflict:19,connect:14,construct:14,consum:20,contain:8,content:8,context:11,context_manag:11,context_scop:11,control:18,control_depend:[18,21],convert:15,core:[8,11,18],correctli:6,correspond:4,could:18,cpu:[3,8,14,18,22],cpuctxsw:22,cpython:18,creat:[0,4,6,12,13,18],criteo:[15,23],csv:15,ctr:20,cuda:[13,22,24],cuda_visible_devic:[8,18],cudabacktrac:22,cudaeventsynchron:13,cudastreamwaitev:13,cupi:14,current:[3,6,8],custom:24,d:14,data:[14,17,18,20,21],data_0:14,data_1:14,data_:14,data_filenam:14,data_filename_prefix:14,data_split:14,dataread:14,dataset:[0,4,6,12,18,23],debug:13,dedic:[13,20,24],deeplearn:20,def:[0,4,6,11,12,18],demo:18,demomodel:18,demonstr:[14,15],denot:4,dens:[2,4,7,12,18],dense_lay:[12,18],dense_opt:[11,18],dense_shap:4,densedemo:[14,16,19,22,23],depend:[13,21],depict:[17,18,20],describ:[17,18],design:20,detail:17,detect:18,determinist:21,devic:[13,21,24],dgx:22,dictionari:8,differ:[6,12,14,17,18,21,24],dim:4,dimens:[0,4,6],directori:3,directrli:20,disabl:13,distribut:[0,2,5,7,8,20,24],distribute_strategi:15,distributed_embed:4,distributedembed:[4,12],distributedsparseembed:24,distributedvari:3,dl:[3,20,24],dlrm:[16,19,23],dnn:[14,18,20],doc:[6,19],docker:20,document:[9,14,15,18],doe:[17,20],download:[15,20],dp:20,dtype:6,due:[18,20],dump:[3,18],dump_to_fil:3,dure:[13,24],dynam:[0,4,24],dynamic_input:0,each:[0,3,4,6,8,14,17,18],easili:24,effici:20,els:18,emb_grad:[11,18],emb_lay:[0,4],emb_opt:[11,18],emb_train_op:18,emb_var:[11,12,18],emb_vector:[0,4,6,18],embed:[7,11,12,18,19,20,21,24],embedding_dim:15,embedding_lay:[6,12,15,18],embedding_lookup:[1,17],embedding_lookup_spars:[5,17],embedding_vari:[3,12],embedding_vec_s:[0,3,4,6,14,15,18,22],embedding_vector_s:18,embeddingvari:[0,3,4],enabl:13,encod:17,end:18,engin:[0,4],enough:14,enumer:[0,4,6,12,18],env:13,environ:[18,19],equal:[0,3,4,13],equival:[1,5,17],estim:20,evalu:8,even:18,exampl:[0,3,4,6,8,11,12,13,14,17,18,19,22],except:[13,17],exchang:17,exec:22,execut:[3,8,21],exist:[18,21],experiment:6,experimental_aggregate_gradi:[11,18],expert:18,explicitli:3,extract:20,f:22,fals:[0,11,18],familiar:18,featur:[0,4,14,18,19],feed:20,field:17,fig:18,file:[0,3,4,6,14,15,18],filenam:14,filepath:3,find:[14,15,20],first:[0,4,6,8,18],first_batch:18,fit:20,fix:[21,24],float32:6,follow:[15,17,20],forc:21,fork:22,format:18,former:14,forward:[0,4,6,17],framework:[3,20,24],from:[0,3,12,14,17],from_logit:18,fulli:[14,18,20],further:[17,20],futur:21,gain:9,gather:[0,17,24],gen_data:14,gener:6,get:19,gil:18,git:20,github:[15,20],global_batch_s:[8,14,15,18],global_variables_initi:18,glorotnorm:6,googl:9,gpu:[0,4,6,8,9,13,18,19,20,21,22],gpu_id:[0,4,17],gpu_num:[0,4,17],grad:18,gradient:[11,17,18],gradienttap:[11,12,18],greater:24,group:18,h:[14,18],ha:14,handl:11,hang:[21,24],hard:[18,20],hash:24,hashtabl:[0,4],have:[14,20],here:20,hidden:18,horovod:[8,20,24],horovodrun:[14,18],host:3,hous:20,how:[4,13,14,15,18],http:[9,15,20],huge:[17,20],hugectr:[15,24],hvd:[8,18],i:[0,4,6,18],ident:[9,18],identityhasht:24,imag:20,impact:18,implement:[1,5,9,14,17,20,24],index:[0,4,18],indic:[4,13],infer:[18,20],info:18,inform:17,init:[8,18],init_op:18,initi:[6,7,18,19],initil:18,input:[0,4,6,11,12,17,18,20,24],input_fil:15,insert:[0,4,24],insid:9,instal:[19,24],instanc:[14,18,20],instruct:15,int32:6,int64:6,integ:[0,4,6],integr:[20,24],interpret:18,intra:[4,14,17],introduc:22,introduct:[17,19],io:20,issu:[19,24],iter:[0,4,18],iter_num:14,its:[0,6,8,9,13,14,17,18],json:18,just:3,kei:[0,4,6,17,18,24],kera:[0,4,9,11,12,18],keyword:8,kind:13,known:[4,17,19],kwarg:[0,4,6,8,9,12,18],lab:15,label:[0,4,6,11,12,18],labl:18,last:14,launch:[8,18,21],layer:[0,3,4,6,12,18,19,20,21],lazy_adam:9,lazyadam:9,lazyadamoptim:9,learning_r:18,len:18,let:14,leverag:[6,8,18,20],like:[3,14],linearli:14,linux:22,list:[3,11,12,18],littl:20,load:3,load_embedding_valu:3,local:7,local_rank:18,local_variables_initi:18,localhost:[14,18],locat:20,log:15,logic:[0,4,6],logit:[11,18],look:[0,4,17,20],lookup:[0,24],loss:[11,12,18],loss_fn:[11,12,18],loss_v:18,machin:[17,18,20],mai:11,main:[15,18],major:0,make:[3,13,18,21],manag:[3,11],mani:18,manner:[17,20],map:24,mark:13,master:15,matter:20,max:4,max_feature_num:4,max_nnz:4,max_vocabulary_size_per_gpu:[0,4,14,18],maximum:4,mean:[0,4,5,13,17,20,24],memori:[4,20],merlin:20,method:14,might:[18,21],minim:20,mirroredstrategi:24,mix:20,mode:13,model:[6,11,12,15,19,20],modul:14,more:[18,20],most:20,mp:[17,20],mpi4pi:14,mpi:[18,22],mpiexec:[14,15,18],multi:[18,24],multipl:[3,6,13,17,18,20,21,22],multiwork:15,must:[0,3,4,6,8,18,21],n:14,name:[9,14],nativ:[11,18],nccl:19,need:[3,11,12,20],next:11,nn:[1,5,17,18],nnz_per_slot:[0,14,18,22],node:[20,24],none:[0,3,6,18,22],normal:12,note:[6,11,18,19],now:18,np:[14,15,18],nsightsystem:22,nsy:22,num_dense_lay:14,num_of_dense_lay:18,num_output_fil:15,number:[0,4,18],numpi:6,nvcr:20,nvidia:20,nvtx:[13,14,22],o:22,obtain:9,off:13,offici:15,ok:[3,8],one:[14,17,18,20],onli:[8,9,11,13,18,20],op:[3,13,24],oper:[17,20],optim:[7,10,14,18,19,24],optimizerscop:[11,18],option:15,order:21,org:15,origin:22,os:18,other:[3,8,12,13,18,20],other_grad:[11,18],other_opt:11,other_train_op:18,other_var:[11,12,18],other_vari:12,otherwis:[0,4,13,21],our:20,out:12,out_lay:18,output:14,output_path:15,overhead:17,oversubscrib:14,own:[14,18],packag:20,paral:17,parallel:[6,14,18,19,20],paramet:[0,3,4,6,8,11,12,20],pattern:[0,24],pdf:15,per:18,perflab:23,perform:[9,18,19],pictur:[17,20],pip:[20,24],pleas:[8,9,13,18,20],port:18,print:18,problem:21,procecss:18,process:[0,3,4,8,12,14,15,17,18,20,22],produc:[0,4],profiling_filenam:22,program:[18,21],propag:17,provid:[17,20],py:[14,15,18,20,22],python3:[14,15,18,22],python:[0,4,9,14,18,20],randomli:14,rang:[0,4,18],rank:[3,4,15],rate:20,read:14,recommend:[15,18,20],reduc:[17,18],reduceop:18,reduct:[14,17,18],refer:[9,18],relat:18,releas:[11,13,19],relu:18,replac:9,replica:6,replica_batchs:0,replica_loss:18,replica_output:6,requir:17,reshap:18,resourc:20,respect:[13,14],restor:3,restore_from_fil:3,restrict:18,retur:8,root:[14,15],root_rank:18,row:[0,4],run:[6,8,12,18],run_sok_horovod:14,run_sok_mirroredstrategi:14,run_sok_multiworker_mpi:14,run_tf:14,runtim:[8,19],s0:14,s1:14,s2:14,s3:14,s4:14,s5:14,s6:14,s7:14,s:[3,6,8,13,15,18,21],same:[0,4,13,17,18,21],sampl:[4,14,18,22],save:[3,4,6,14,15],save_prefix:[14,15],saver:[2,7],scale:20,scatter:17,scenario:20,scope:[6,7,8,10,12,18],script:22,second:[0,4,6],section:[17,18],see:[6,20],self:[12,18],semicolon:13,separ:13,sess:[8,18],session:[8,18],set:[8,18],set_visible_devic:[8,18,24],setup:20,sever:[1,5,9,15,17,20,21],shape:[0,3,4,6,18],shose:21,should:[9,17],signatur:18,similar:18,simpl:18,sinc:12,singl:[17,18,20,22,24],size:[0,17],slot:[0,4,14,17],slot_num:[0,4,14,18,22],sm:13,so:[0,4,6,12,18],sok:[0,3,4,8,9,11,12,13,17,18,20,21,22,24],sok_init:8,sok_init_op:18,solut:[20,21],some:[13,18],souc:20,sourc:[0,3,4,6,8,9,11,12,14,15],spars:[2,7,20],sparse_opeation_kit:20,sparse_operation_kit:[0,3,4,6,8,9,11,12,14,15,18,20],sparseopeationkit:20,sparseoperationkit:[13,14,21],sparsetensor:4,specifi:[3,4,6,8,13,14,18],specificli:18,split:12,split_data:14,split_embedding_variable_from_oth:[11,12,18],split_id:14,split_num:14,splite:14,stack:3,start:19,statist:4,statu:[3,8],step:[8,12,18,20],still:3,store:[0,4,6],str:18,strategi:[6,8,11,12,20],stream:[13,24],string:[3,4,6,8],structur:18,successfulli:[3,8,18],sum:[4,5,17,18],support:[5,17,18,20,24],synchron:[13,18,20,24],synchroniz:13,system:[18,20],tabl:17,tape:[11,12,18],target:13,task:18,task_id:18,tensor:[0,3,4,6,18],tensorflow:[0,4,6,8,9,11,13,19,20,22,24],terabyt:[15,23],test:15,test_:15,test_file_pattern:15,tf:[0,1,2,3,4,5,7,8,9,11,12,13,14,15,17,21,22,24],tf_config:18,tf_distributed_embed:6,tf_mp:15,tfdistributedembed:6,than:24,thei:[3,14],them:[1,5],therefor:[4,14,18,20],thi:[0,3,4,6,8,9,11,12,13,17,18],those:[3,12,21],thread:18,through:[18,20],time:[0,4],timelin:22,tini:17,tool:[18,24],top:17,top_stack:15,total:[6,24],total_loss:18,trace:22,train:[0,4,12,15,18,20,24],train_:15,train_file_pattern:15,train_step:18,trainabl:[3,11,12],trainable_vari:[11,12,18],transfer:21,transform:[17,20],treat:3,tree:15,tupl:[3,11,12],tutori:[14,15],two:13,type:[0,3,4,6,8,11,18],under:[8,18],unifi:17,uniqu:[0,9,24],unit:[12,14,18],unsorted_segment_sum:9,unus:18,up:[0,3,4,17,20],updat:7,us:[0,3,4,6,8,9,11,12,13,17,20,21,24],use_hasht:[0,4],use_tf_opt:18,user:20,util:[6,7,19,20],valid:[0,4,18],valu:[3,4,6],variabl:[0,3,4,6,9,11,12,18,19],vector:[0,4,6,12,17,18],veri:20,verifi:23,version:[9,18,19],via:[20,24],visibl:24,vocabulary_s:[6,14],wai:[12,20],wait:13,walk:18,want:[13,18,20],we:[12,14,21],what:19,when:[0,3,4,6,8,9,11,14,17,20,21,24],where:[0,3,4,14,17,18,20],whether:[0,4,13],which:[0,3,4,8,13,14,17,18,20,24],whole:20,whose:[0,4,6],within:3,work:[8,17,20],worker:18,worker_num:18,workflow:20,wrap:20,wrapper:[0,4,6],x:[8,19],xxx:14,you:[3,13,14,15,18,20,21],your:[18,20],yourbinaryfilepath:15,zip:[11,18]},titles:["All2All Dense Embedding","SparseOperationKit Dense Embeddings","SparseOperationKit Embeddings","SparseOperationKit Embedding Saver","Distributed Sparse Embedding","SparseOperationKit Sparse Embeddings","TF Distributed Embedding","SparseOperationKit API","SparseOperationKit Initialize","SparseOperationKit Optimizers","SparseOperationKit Utilities","SparseOperationKit Optimizer Scope","SparseOperationKit Optimizer Utils","Environment Variables","Demo model using Dense Embedding Layer","DLRM using SparseOperationKit","Examples","Features in SparseOperationKit","Get Started With SparseOperationKit","Welcome to SparseOperationKit\u2019s documentation!","SparseOperationKit","Known Issues","Performance of demo model using Dense Embedding Layer","Performance","SparseOperationKit Release Notes"],titleterms:{"0":24,"1":[18,24],"15":18,"2":18,"import":18,"new":24,With:18,accept:13,adam:9,all2al:[0,17],along:20,also:18,api:7,build:20,caution:18,command:22,common:15,compil:13,conflict:21,dataset:[14,15],defin:18,demo:[14,22],dens:[0,1,14,17,22],distribut:[4,6,17,18],dlrm:15,document:[19,20],elaps:22,embed:[0,1,2,3,4,5,6,14,17,22],end2end:22,environ:13,exampl:16,featur:[17,20],from:20,gener:[14,15],get:18,gpu:17,horovod:[14,18],hugectr:20,infrastructur:22,initi:8,instal:[18,20],issu:21,known:21,layer:[14,17,22],local:9,milisecond:22,mirroredstrategi:[14,18],model:[14,17,18,22],modul:20,mpi:14,multipl:14,multiworkermirroredstrategi:[14,18],nccl:21,note:24,number:22,optim:[9,11,12],option1:15,option2:15,parallel:17,param:15,per:22,perform:[22,23],profil:22,pypi:20,queri:22,refer:15,releas:24,requir:14,run:[14,15],runtim:13,s:[19,24],saver:3,scope:11,second:22,see:18,set:15,shard:14,sok:[14,15],sok_compile_async:13,sok_compile_build_typ:13,sok_compile_gpu_sm:13,sok_compile_use_nvtx:13,sok_event_sync:13,sourc:20,spars:[4,5,17],sparseoperationkit:[1,2,3,5,7,8,9,10,11,12,15,17,18,19,20,24],split:14,start:18,step:[14,15],strategi:18,structur:14,tensorflow:[14,15,18],tf:[6,18],thi:[14,20],time:22,tip:18,updat:9,us:[14,15,18,22],util:[10,12],valu:13,variabl:13,version:24,welcom:19,what:24,whole:14,writen:14,x:18}})