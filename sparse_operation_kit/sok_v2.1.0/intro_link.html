<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SparseOperationKit &mdash; SparseOperationKit  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Get Started With SparseOperationKit" href="get_started/get_started.html" />
    <link rel="prev" title="Welcome to SparseOperationKit’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            SparseOperationKit
          </a>
              <div class="version">
                2.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#features">Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#obtaining-sok-and-hugectr-via-docker">Obtaining SOK And HugeCTR Via Docker</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installing-sok-via-pip">Installing SOK Via PIP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installing-sok-from-source">Installing SOK From Source</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pre-requisites">Pre-requisites</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#documents">Documents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="get_started/get_started.html">Get Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/index.html">API Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_notes/release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="env_vars/env_vars.html">Environment Variables</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SparseOperationKit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">SparseOperationKit</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/intro_link.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="sparseoperationkit">
<h1>SparseOperationKit<a class="headerlink" href="#sparseoperationkit" title="Permalink to this heading"></a></h1>
<p>Sparse Operation Kit (SOK) is a Python package wrapped GPU accelerated operations dedicated for sparse training / inference cases. It is designed to be compatible with common deep learning (DL) frameworks like TensorFlow.</p>
<p>Most of the algorithm implementations in SOK are extracted from HugeCTR. HugeCTR is a GPU-accelerated recommender framework designed to distribute training across multiple GPUs and nodes for Click-Through Rate (CTR) estimation. If you are looking for a very efficient solution for CTR estimation, please see the HugeCTR <a class="reference external" href="https://github.com/NVIDIA-Merlin/HugeCTR#readme">documentation</a> or our GitHub <a class="reference external" href="https://github.com/NVIDIA-Merlin/HugeCTR">repository</a>.</p>
<section id="features">
<h2>Features<a class="headerlink" href="#features" title="Permalink to this heading"></a></h2>
<p><strong>Model-Parallelism GPU Embedding Layer</strong> <br>
In sparse training / inference scenarios, for instance, CTR estimation, there are vast amounts of parameters which cannot fit into the memory of a single GPU. Many common DL frameworks only offer limited support for model parallelism (MP), because it can complicate using all available GPUs in a cluster to accelerate the whole training process.</p>
<p>SOK provides broad MP functionality to fully utilize all available GPUs, regardless of whether these GPUs are located in a single machine or multiple machines. Simultaneously, SOK takes advantage of existing data-parallel (DP) capabilities of DL frameworks to accelerate training while minimizing code changes. With SOK embedding layers, you can build a DNN model with mixed MP and DP. MP is used to shard large embedding parameter tables, such that they are distributed among the available GPUs to balance the workload, while DP is used for layers that only consume little GPU resources.</p>
<p>SOK is compatible with DP training provided by common synchronized training frameworks, such as <a class="reference external" href="https://horovod.ai">Horovod</a>. Because the input data fed to these embedding layers can take advantage of DP, additional DP from/to MP transformations are needed when SOK is used to scale up your DNN model from single GPU to multiple GPUs. The following picture illustrates the workflow of these embedding layers.
<img alt="WorkFlowOfEmbeddingLayer" src="_images/workflow_of_embeddinglayer1.png" /></p>
<p><strong>Dynamic Embedding Backend</strong> <br>
SOK provides a dynamic embedding table with hash functionality. The features of the dynamic embedding table are as follows:</p>
<ul class="simple">
<li><p>The memory capacity of the embedding table dynamically grows during training and automatically evicts entries when the limit is reached.</p></li>
<li><p>dynamic embedding table can accepts pre-hashed indices.</p></li>
</ul>
<p>To achieve these two functions, SOK uses <a class="reference external" href="https://github.com/NVIDIA-Merlin/HierarchicalKV">HierarchicalKV</a> as the backend.</p>
<p>HierarchicalKV(Abbreviated as HKV) is a part of NVIDIA Merlin and provides hierarchical key-value storage to meet RecSys requirements.For more detailed information about HKV, you can read documents the <a class="reference external" href="https://github.com/NVIDIA-Merlin/HierarchicalKV">HKV repo</a>. Here, SOK lists some key points of HKV for recommendation systems:</p>
<ol class="arabic simple">
<li><p>HKV supports lookup with pre-hashed indices.</p></li>
<li><p>HKV supports setting a capacity limit for the embedding table. When the embedding table reaches its capacity, it can evict embedding vectors using strategies such as LRU and LFU.</p></li>
<li><p>HKV can configure the location of the embedding vectors to either GPU global memory or Host memory, take full advantage of the system’s memory.</p></li>
</ol>
<p>With these features of HKV, SOK can easily support more flexible lookup of indices, while also expanding the capacity of the embedding table to a large size.</p>
<p>How to use dynamic embedding in SOK, referencing <a class="reference external" href="https://nvidia-merlin.github.io/HugeCTR/sparse_operation_kit/master/get_started/get_started.html#sok-dynamicvariable">SOK DynamicVariable</a></p>
<p>How to use dynamic embedding training DLRM, referencing <a class="reference external" href="https://github.com/NVIDIA-Merlin/HugeCTR/tree/main/sparse_operation_kit/notebooks">SOK Notebooks</a></p>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this heading"></a></h2>
<p>There are several ways to install this package. <br></p>
<section id="obtaining-sok-and-hugectr-via-docker">
<h3>Obtaining SOK And HugeCTR Via Docker<a class="headerlink" href="#obtaining-sok-and-hugectr-via-docker" title="Permalink to this heading"></a></h3>
<p>This is the quickest way to get started with SOK.
We provide containers with pre-compiled binaries of the latest HugeCTR and SOK versions(also can manually install SOK into <code class="docutils literal notranslate"><span class="pre">nvcr.io/nvidia/tensorflow</span> <span class="pre">series</span></code> images).
To get started quickly with container on your machine, run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span>nvcr.io/nvidia/merlin/merlin-tensorflow:23.11
</pre></div>
</div>
<blockquote>
<div><p>In production, replace the <code class="docutils literal notranslate"><span class="pre">latest</span></code> tag with a specific version.
Refer to the <a class="reference external" href="https://catalog.ngc.nvidia.com/orgs/nvidia/teams/merlin/containers/merlin-tensorflow">Merlin TensorFlow</a>
container page on NGC for more information.</p>
</div></blockquote>
<p>Sparse Operation Kit is already installed in the container.
You can import the library as shown in the following code block:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sparse_operation_kit</span> <span class="k">as</span> <span class="nn">sok</span>
</pre></div>
</div>
</section>
<section id="installing-sok-via-pip">
<h3>Installing SOK Via PIP<a class="headerlink" href="#installing-sok-via-pip" title="Permalink to this heading"></a></h3>
<p>You can install SOK using the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>sparse_operation_kit<span class="w"> </span>--no-build-isolation
</pre></div>
</div>
</section>
<section id="installing-sok-from-source">
<h3>Installing SOK From Source<a class="headerlink" href="#installing-sok-from-source" title="Permalink to this heading"></a></h3>
<p>You can also build the SOK module from source code. Here are the steps to follow: <br></p>
<ul>
<li><p><strong>Download the source code</strong></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/NVIDIA-Merlin/HugeCTR<span class="w"> </span>hugectr
</pre></div>
</div>
</li>
<li><p><strong>Install to system from python setup install</strong></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>hugectr/
$<span class="w"> </span>git<span class="w"> </span>submodule<span class="w"> </span>update<span class="w"> </span>--init<span class="w"> </span>--recursive
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>sparse_operation_kit/
$<span class="w"> </span>python<span class="w"> </span>setup.py<span class="w"> </span>install
</pre></div>
</div>
</li>
<li><p><strong>Install to system from cmake</strong></p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>hugectr/
$<span class="w"> </span>git<span class="w"> </span>submodule<span class="w"> </span>update<span class="w"> </span>--init<span class="w"> </span>--recursive
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>sparse_operation_kit/
$<span class="w"> </span>mkdir<span class="w"> </span>build<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>build
$<span class="w"> </span>cmake<span class="w"> </span>-DSM<span class="o">={</span>your<span class="w"> </span>GPU<span class="w"> </span>SM<span class="w"> </span>version<span class="o">}</span><span class="w"> </span>../
$<span class="w"> </span>make<span class="w"> </span>-j<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>make<span class="w"> </span>install
$<span class="w"> </span>cp<span class="w"> </span>-r<span class="w"> </span>../sparse_operation_kit<span class="w"> </span><span class="o">{</span>image<span class="w"> </span>python<span class="w"> </span>dist-packages<span class="w"> </span>folder,<span class="w"> </span><span class="k">for</span><span class="w"> </span>example:/usr/local/lib/python3.10/dist-packages/<span class="o">}</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="pre-requisites">
<h3>Pre-requisites<a class="headerlink" href="#pre-requisites" title="Permalink to this heading"></a></h3>
<p>CUDA Version:&gt;= 11.2</p>
<p>TF2 Version:2.6.0~2.14.0</p>
<p>TF1 Version:1.15</p>
<p>Cmake Version:&gt;= 3.20</p>
<p>GCC Version:&gt;=9.3.0</p>
<p>Build requires: scikit-build&gt;=0.13.1, ninja</p>
</section>
</section>
<section id="documents">
<h2>Documents<a class="headerlink" href="#documents" title="Permalink to this heading"></a></h2>
<p>Want to find more about SparseOperationKit? Take a look at the <a class="reference external" href="https://nvidia-merlin.github.io/HugeCTR/sparse_operation_kit/master/index.html">SparseOperationKit documentation</a>!</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to SparseOperationKit’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="get_started/get_started.html" class="btn btn-neutral float-right" title="Get Started With SparseOperationKit" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, NVIDIA.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    master: sok_v2.1.0
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Tags</dt>
      <dd><a href="../sok_v1.0.0/intro_link.html">sok_v1.0.0</a></dd>
      <dd><a href="../sok_v1.1.0/intro_link.html">sok_v1.1.0</a></dd>
      <dd><a href="../sok_v1.1.1/intro_link.html">sok_v1.1.1</a></dd>
      <dd><a href="../sok_v1.1.2/intro_link.html">sok_v1.1.2</a></dd>
      <dd><a href="../sok_v1.1.4/intro_link.html">sok_v1.1.4</a></dd>
      <dd><a href="../sok_v2.0.0/intro_link.html">sok_v2.0.0</a></dd>
      <dd><a href="intro_link.html">sok_v2.1.0</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>