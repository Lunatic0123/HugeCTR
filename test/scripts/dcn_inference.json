{
  "inference": {
    "max_batchsize": 4096,
    "hit_rate_threshold": 0.6,
    "dense_model_file": "/hugectr/test/utest/_dense_10000.model",
    "sparse_model_file": "/hugectr/test/utest/0_sparse_10000.model"
  },
  "layers": [
    {
      "name": "data",
      "type": "Data",
      "check": "Sum",
      "label": {
        "top": "label",
        "label_dim": 1
      },
      "dense": {
        "top": "dense",
        "dense_dim": 13
      },
      "sparse": [
        {
          "top": "data1",
          "type": "DistributedSlot",
          "slot_num": 26,
          "is_fixed_length": false,
          "nnz_per_slot": 2
        }
      ]
    },

    {
      "name": "sparse_embedding1",
      "type": "DistributedSlotSparseEmbeddingHash",
      "bottom": "data1",
      "top": "sparse_embedding1",
      "sparse_embedding_hparam": {
        "embedding_vec_size": 16,
        "combiner": "mean",
        "workspace_size_per_gpu_in_mb": 107
      }
    },
    {
      "name": "reshape1",
      "type": "Reshape",
      "bottom": "sparse_embedding1",
      "top": "reshape1",
      "leading_dim": 416
    },
    {
      "name": "concat1",
      "type": "Concat",
      "bottom": [
        "reshape1",
        "dense"
      ],
      "top": "concat1"
    },
    {
      "name": "fc1",
      "type": "InnerProduct",
      "bottom": "concat1",
      "top": "fc1",
      "fc_param": {
        "num_output": 200
      }
    },
    {
      "name": "relu1",
      "type": "ReLU",
      "bottom": "fc1",
      "top": "relu1"
    },
    {
      "name": "fc2",
      "type": "InnerProduct",
      "bottom": "relu1",
      "top": "fc2",
      "fc_param": {
        "num_output": 200
      }
    },
    {
      "name": "relu2",
      "type": "ReLU",
      "bottom": "fc2",
      "top": "relu2"
    },
    {
      "name": "fc3",
      "type": "InnerProduct",
      "bottom": "relu2",
      "top": "fc3",
      "fc_param": {
        "num_output": 200
      }
    },
    {
      "name": "relu3",
      "type": "ReLU",
      "bottom": "fc3",
      "top": "relu3"
    },
    {
      "name": "fc4",
      "type": "InnerProduct",
      "bottom": "relu3",
      "top": "fc4",
      "fc_param": {
        "num_output": 1
      }
    },
    {
      "name": "sigmoid",
      "type": "Sigmoid",
      "bottom": "fc4",
      "top": "sigmoid"
    }
  ]
}